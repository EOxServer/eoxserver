/* libcoverage.js - version 0.1.4 - 2014-07-10
 * See https://github.com/EOX-A/libcoverage.js for more information! */
namespace("WCS.Backbone").Model=function(){var a=function(a,b){return a&&a[b]?_.isFunction(a[b])?a[b]():a[b]:null},b=Backbone.Model.extend({initialize:function(a){a.urlRoot&&(this.urlRoot=a.urlRoot,delete a.urlRoot)},fetch:function(a){a||(a={}),a.dataType="xml",Backbone.Model.prototype.fetch.call(this,a)}}),c=Backbone.Collection.extend({fetch:function(a){a||(a={}),a.dataType="xml",Backbone.Collection.prototype.fetch.call(this,a)}}),d={};return d.Service=b.extend({url:function(){return WCS.Core.KVP.getCapabilitiesURL(a(this,"urlRoot"))},parse:function(a){return WCS.Core.Parse.parse(a)},fetchAdvertisedCoverages:function(a){var b=this.get("contents"),c=[];b&&(c=_.pluck(b.coverages,"coverageId"));var d=new CoverageSet([],{urlRoot:this.urlRoot,coverageIds:c});return d.fetch(a),d}}),d.Coverage=b.extend({idAttribute:"coverageId",url:function(){var b=a(this,"urlRoot")||a(this.collection,"url");return this.id?WCS.Core.KVP.describeCoverageURL(b,this.id):void 0},parse:function(a){return _.has(a,"coverageId")?a:WCS.Core.Parse.parse(a).coverageDescriptions[0]},getRangeType:function(){return this.get("rangeType")},getDownloadUrl:function(b){var c=a(this,"urlRoot")||a(this.collection,"urlRoot");return WCS.Core.KVP.getCoverageURL(c,this.id,b)}}),d.CoverageSet=c.extend({model:d.Coverage,initialize:function(a,b){this._ids=0==a.length?b.coverageIds||[]:_.pluck(a,id),this.urlRoot=b.urlRoot||this.urlRoot},url:function(){return WCS.Core.KVP.describeCoverageURL(this.urlRoot,this._ids)},parse:function(a){return WCS.Core.Parse.parse(a).coverageDescriptions}}),namespace("WCS").EO&&(d.EOCoverageSet=c.extend({initialize:function(a,b){this.options=b||{},this.type=b.type||this.type,this.type&&(delete b.type,"coverages"===this.type?this.model=d.Coverage:"datasetSeries"===this.type&&(this.model=d.DatasetSeries)),this.urlRoot=b.urlRoot||this.urlRoot,this.eoid=b.eoid||this.eoid},url:function(){return WCS.EO.KVP.describeEOCoverageSetURL(this.urlRoot,this.eoid,this.options)},parse:function(a){var b=WCS.Core.Parse.parse(a);switch(this.coverageDescriptions=b.coverageDescriptions,this.datasetSeriesDescriptions=b.datasetSeriesDescriptions,this.type){case"coverages":return b.coverageDescriptions;case"datasetSeries":return b.datasetSeriesDescriptions;default:return _.union(b.coverageDescriptions,b.datasetSeriesDescriptions)}}})),d}();